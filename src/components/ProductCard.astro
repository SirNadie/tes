---
interface Props {
    id: string;
    title: string;
    price: number;
    image: string;
    category?: string;
}

import AddToCartButton from "./AddToCartButton";

const { id, title, price, image, category } = Astro.props;
---

<div
    class="product-card group relative bg-white rounded-xl overflow-hidden shadow-sm hover:shadow-xl transition-all duration-300 hover:-translate-y-1"
>
    <!-- Image Container -->
    <div
        class="aspect-square w-full overflow-hidden bg-gradient-to-br from-gray-50 to-gray-100"
    >
        <img
            src={image}
            alt={title}
            class="h-full w-full object-cover object-center transition-transform duration-500 group-hover:scale-110"
            loading="lazy"
        />
        <!-- Quick View Overlay -->
        <div
            class="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-all duration-300 flex items-center justify-center"
        >
            <a
                href={`/products/${id}`}
                class="opacity-0 group-hover:opacity-100 transform scale-90 group-hover:scale-100 transition-all duration-300 bg-white/90 backdrop-blur-sm text-gray-900 px-6 py-2 rounded-full font-medium shadow-lg hover:bg-white"
            >
                Quick View
            </a>
        </div>
    </div>

    <!-- Product Info -->
    <div class="p-5">
        <!-- Category Badge -->
        {
            category && (
                <span class="inline-block text-xs font-medium uppercase tracking-wider text-primary/70 mb-2">
                    {category}
                </span>
            )
        }

        <!-- Title & Price Row -->
        <div class="flex justify-between items-start gap-3">
            <h3
                class="text-base font-medium text-gray-900 line-clamp-2 leading-snug"
            >
                <a
                    href={`/products/${id}`}
                    class="hover:text-primary transition-colors"
                >
                    {title}
                </a>
            </h3>
            <p class="text-lg font-semibold text-primary whitespace-nowrap">
                ${price.toFixed(2)}
            </p>
        </div>

        <!-- Add to Cart Button -->
        <div class="mt-4">
            <AddToCartButton
                client:visible
                product={{
                    id: id,
                    title,
                    price,
                    image,
                    category: category || "General",
                } as any}
            />
        </div>
    </div>
</div>

<style>
    .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
</style>
